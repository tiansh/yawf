<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="keywords" content="YAWF, Yet Another Weibo Filter, 看真正想看的微博, 正则式, 正则表达式, 过滤, 规则, 屏蔽" />
  <meta name="description" content="通过介绍一些常见的用于过滤微博的正则表达式，让您快速掌握使用正则表达式过滤微博的方法。您可以从这篇文章中选取一些您需要的正则式来使用，也可以仿照这些正则式编写自己的正则式。" />
  <title>用于过滤微博的正则表达式快速入门</title>
  <link rel="canonical" href="https://tiansh.github.io/yawf/regexp.html">
  <link rel="icon" href="https://tiansh.github.io/yawf/yawf.ico" />
  <link rel="stylesheet" href="css/main.css" />
  <script src="js/main.js"></script>
  <style>code { background-color: #eee; }</style>
</head>
<body>
  <article class="hentry">
    <header>
      <div id="icon">
        <svg version="1.1" id="yawf-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 96 96">
          <path style="fill:#D92D3A;" d="M12,54c11.687-0.576,21.197-0.143,24.75,7.5c3.398,5.701,0.191,13.075-1.5,18c3.936,0.705,6.164,2.012,8.25,4.5c-10.499,0-21.001,0-31.5,0C12,74.001,12,63.999,12,54z" />
          <path style="fill:#E98D49;" d="M71.366,28.911c-11.204-13.26-27.73-18.315-42.984-14.853h-0.006c-3.53,0.807-5.78,4.513-5.024,8.274c0.752,3.764,4.224,6.169,7.753,5.366c10.852-2.46,22.595,1.138,30.56,10.558c7.957,9.419,10.119,22.266,6.711,33.528l0.002,0.002c-1.111,3.669,0.769,7.593,4.21,8.779c3.427,1.185,7.111-0.819,8.223-4.479c0-0.007,0-0.021,0.002-0.027C85.595,60.217,82.574,42.158,71.366,28.911" />
          <path style="fill:#E98D49;" d="M54.161,45.486c-5.453-6.458-13.505-8.911-20.938-7.224c-3.038,0.691-4.974,3.883-4.322,7.128c0.65,3.232,3.637,5.309,6.668,4.605v0.007c3.633-0.82,7.573,0.376,10.239,3.527c2.669,3.158,3.386,7.46,2.241,11.235h0.006c-0.952,3.151,0.664,6.539,3.618,7.56c2.955,1.01,6.125-0.71,7.079-3.869C61.086,60.739,59.625,51.943,54.161,45.486" />
        </svg>
      </div>
      <h1 class="entry-title">用于过滤微博的正则表达式快速入门</h1>
    </header>
    <nav class="index"><span class="tol">目录</span></nav>
    <div class="entry-content">
      <p>很多消息过滤的脚本都提供了按正则表达式过滤的功能，正则表达式功能十分强大，用好正则表达式，可以让书写规则事半功倍。</p>
      <p>还没安装脚本的话，可以先戳 <a href="https://tiansh.github.io/yawf/">YAWF脚本主页</a>，根据说明安装好脚本；或者先读完本文，看看正则表达式都能帮你写出怎样的规则，再考虑要不要安装也不迟。</p>
      <p>这篇文章不打算系统地介绍正则表达式的使用，而是希望用举例的方法介绍常用的一些常见的写法和用法。你可以从这篇文章中选取一些您需要的正则式来使用，也可以仿照这些正则式编写自己的正则式。</p>
      <p>如果您希望系统地学习正则表达式，您可以参考这些网络资源：</p>
      <ul>
        <li><a href="http://deerchao.net/tutorials/regex/regex.htm">正则表达式30分钟入门教程</a></li>
        <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions">MDN上关于正则表达式的文档</a></li>
      </ul>
      <p>如果你有不错的过滤规则，也欢迎和大家分享分享。</p>
      <h2>换行和空白</h2>
      <p>
        举例：<code>/\n/</code><br />
        举例：<code>/\s/</code><br />
        说明：关键词屏蔽会忽略规则开头和结尾的空白字符，所以在匹配这些字符时可能需要使用正则表达式。<code>\s</code>表示任意空白字符，包括半角空格、全角空格、换行等等；<code>\n</code>表示换行符。
      </p>
      <h2>任意字符</h2>
      <p>
        举例：<code>/我刚换了.*模板/</code><br />
        举例：<code>/我更新了微博.*客户端/</code><br />
        说明：正则式和一般用的通配符不一样，如果想匹配任何内容，需要用 <code>.*</code> 来表示。其中 <code>.</code> 表示随便什么字符（换行除外）都匹配， <code>*</code> 表示不管有几个都匹配。如果需要匹配换行符，可以用 <code>[\s\S]</code> 代替 <code>.</code> 。
      </p>
      <h2>一系列词汇中的任意一个</h2>
      <p>
        举例：<code>/[乜佢咁咗係掂揾睇嘅嗰嘢]/</code><br />
        说明：半角的方括号，表示里面出现的这些字，出现任何一个都算匹配成功。比如上面这条正则式，微博里面出现了这些字的任意一个都可以匹配到。
      </p>
      <p>
        举例：<code>/[가-힣]/</code><br />
        说明：如果是编码连续的若干个字符，可以用一个半角的减号来省略中间的字符。例如这条规则可以匹配包含任意朝鲜语字母的字符串。（至于什么是字符编码，如果不清楚也不用深究，总之就是电脑内对字符的一种排列方式，类似于字典里面从某个字排在第几个的意思。）
      </p>
      <p>
        举例：<code>/[\u3041-\u3096\u30A0-\u30FF\uFF5F-\uFF9F\u31F0-\u31FF\u3220-\u3243\u3280-\u337F]/</code><br />
        说明：除了直接写出文字，也可以用 <code>\uXXXX</code> 的方式来表示一个字符，XXXX处填写的是这个字符的编码。（作为一个比较高级的功能，如果不明白也不用担心，能看懂就好了。）上面这个正则式匹配包含日语平假名、片假名或一些日语专用字符的字符串。
      </p>
      <p>
        举例：<code>/抽[一二三四五六七八九十1-9两俩仨]/</code><br />
        说明：匹配一系列词汇中任何一个的规则可以和直接匹配文本的规则共同使用。比如这条正则式会匹配含有“抽一个”“抽两名”“抽仨人”等类似内容的字符串。
      </p>
      <p>
        举例：<code>/(双子|双鱼|处女|天秤|天蝎|射手|巨蟹|摩羯|水瓶|狮子|白羊|金牛)/</code><br />
        说明：竖线表示两边的规则满足任何一个都算匹配，对于多字的词汇，就需要用这种方法来表示。比如对于上面这条规则，一个字符串包含这十二个词中的任何一个都会被匹配。
      </p>
      <h2>同时满足若干个规则</h2>
      <p>
        举例：<code>/^(?=[\s\S]*抽)(?=[\s\S]*送)/</code><br />
        说明：使用 <code>/^(?=[\s\S]*XXX)(?=[\s\S]*YYY)(?=[\s\S]*ZZZ)/</code> 的格式可以匹配同时满足XXX、YYY和ZZZ等三条规则的字符串。比如上面举例的这条规则可以匹配同时带有“抽”和“送”两个字的微博。<span style="opacity: 0.6">如果你好奇这是怎么工作的，这里有具体地说明（当然，看不懂不会影响你用这个强大的过滤规则）： <code>^</code> 表示从字符串开始的位置匹配； <code>(?=xxx)</code> 表示匹配规则xxx，但是不捕获（大概可以理解为检查后面是不是匹配特定规则，但是检查之后光标不往后移动）； <code>[\s\S]*</code> 表示从开头到要匹配的规则之间可以有任意的内容。</span>
      </p>
      <p>
        举例：<code>/^(?=[\s\S]*转发)(?=[\s\S]*(好事|好运|中奖|运气|锦鲤|许愿|愿望|实现))/</code><br />
        说明：这条规则可以匹配出现“转发”一词的同时，出现后面这些词中的任意一个的微博。
      </p>
      <h2>其他规则举例</h2>
      <p>
        举例：<code>/([微薇危威葳崴徽徵VＶvｖ]|wei)([\(\)\[\]\{（）【】『』［］｛｝].){0,3}([信亻性姓]|xin)/</code><br />
        说明：评论里面经常出现的“请加我微信”一类评论，他们为了躲避新浪的关键词过滤机制，使用各种近似的字符表示“微信”这个词，而且中间还会插入各种乱七八糟的字符。这个正则式可以帮你找到这些评论。其中的 <code>?</code> 表示可有可无， <code>{0,3}</code> 表示“零到三个”。
      </p>
      <h2>重复内容</h2>
      <p>
        举例：<code>/(.+)\1{4}/</code>
        说明：如上规则可以匹配将某段文本连续重复5遍（或以上）的字串。前面的 <code>(.+)</code> 匹配第一遍，后面的 <code>\1</code> 表示和第一遍的内容一样，<code>{4}</code> 表示重复4遍。
      </p>
      <p>
        举例：<code>/(?:^|\n)(.+)(?=\n)([\s\S]*?(?:\n)\1(?=\n|$)){3}/</code>
        说明：如上规则匹配将同样的行重复四遍的字串。这样的微博一般会中间用标点之类的无意义内容撑开很多行，只是为了让你点击“展开全文”才能看到结尾。
      </p>
    </div>
  </article>
</body>
</html>
